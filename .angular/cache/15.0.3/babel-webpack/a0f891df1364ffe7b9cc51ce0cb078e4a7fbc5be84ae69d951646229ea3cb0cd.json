{"ast":null,"code":"import { innerFrom } from '../observable/innerFrom';\nimport { Subject } from '../Subject';\nimport { SafeSubscriber } from '../Subscriber';\nimport { operate } from '../util/lift';\nexport function share() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var _options$connector = options.connector,\n    connector = _options$connector === void 0 ? function () {\n      return new Subject();\n    } : _options$connector,\n    _options$resetOnError = options.resetOnError,\n    resetOnError = _options$resetOnError === void 0 ? true : _options$resetOnError,\n    _options$resetOnCompl = options.resetOnComplete,\n    resetOnComplete = _options$resetOnCompl === void 0 ? true : _options$resetOnCompl,\n    _options$resetOnRefCo = options.resetOnRefCountZero,\n    resetOnRefCountZero = _options$resetOnRefCo === void 0 ? true : _options$resetOnRefCo;\n  return function (wrapperSource) {\n    var connection;\n    var resetConnection;\n    var subject;\n    var refCount = 0;\n    var hasCompleted = false;\n    var hasErrored = false;\n    var cancelReset = function cancelReset() {\n      resetConnection === null || resetConnection === void 0 ? void 0 : resetConnection.unsubscribe();\n      resetConnection = undefined;\n    };\n    var reset = function reset() {\n      cancelReset();\n      connection = subject = undefined;\n      hasCompleted = hasErrored = false;\n    };\n    var resetAndUnsubscribe = function resetAndUnsubscribe() {\n      var conn = connection;\n      reset();\n      conn === null || conn === void 0 ? void 0 : conn.unsubscribe();\n    };\n    return operate(function (source, subscriber) {\n      refCount++;\n      if (!hasErrored && !hasCompleted) {\n        cancelReset();\n      }\n      var dest = subject = subject !== null && subject !== void 0 ? subject : connector();\n      subscriber.add(function () {\n        refCount--;\n        if (refCount === 0 && !hasErrored && !hasCompleted) {\n          resetConnection = handleReset(resetAndUnsubscribe, resetOnRefCountZero);\n        }\n      });\n      dest.subscribe(subscriber);\n      if (!connection && refCount > 0) {\n        connection = new SafeSubscriber({\n          next: function next(value) {\n            return dest.next(value);\n          },\n          error: function error(err) {\n            hasErrored = true;\n            cancelReset();\n            resetConnection = handleReset(reset, resetOnError, err);\n            dest.error(err);\n          },\n          complete: function complete() {\n            hasCompleted = true;\n            cancelReset();\n            resetConnection = handleReset(reset, resetOnComplete);\n            dest.complete();\n          }\n        });\n        innerFrom(source).subscribe(connection);\n      }\n    })(wrapperSource);\n  };\n}\nfunction handleReset(reset, on) {\n  if (on === true) {\n    reset();\n    return;\n  }\n  if (on === false) {\n    return;\n  }\n  var onSubscriber = new SafeSubscriber({\n    next: function next() {\n      onSubscriber.unsubscribe();\n      reset();\n    }\n  });\n  for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    args[_key - 2] = arguments[_key];\n  }\n  return on.apply(void 0, args).subscribe(onSubscriber);\n}","map":{"version":3,"names":["innerFrom","Subject","SafeSubscriber","operate","share","options","connector","resetOnError","resetOnComplete","resetOnRefCountZero","wrapperSource","connection","resetConnection","subject","refCount","hasCompleted","hasErrored","cancelReset","unsubscribe","undefined","reset","resetAndUnsubscribe","conn","source","subscriber","dest","add","handleReset","subscribe","next","value","error","err","complete","on","onSubscriber","args"],"sources":["C:/Users/User/Projects/meanstack/node_modules/rxjs/dist/esm/internal/operators/share.js"],"sourcesContent":["import { innerFrom } from '../observable/innerFrom';\nimport { Subject } from '../Subject';\nimport { SafeSubscriber } from '../Subscriber';\nimport { operate } from '../util/lift';\nexport function share(options = {}) {\n    const { connector = () => new Subject(), resetOnError = true, resetOnComplete = true, resetOnRefCountZero = true } = options;\n    return (wrapperSource) => {\n        let connection;\n        let resetConnection;\n        let subject;\n        let refCount = 0;\n        let hasCompleted = false;\n        let hasErrored = false;\n        const cancelReset = () => {\n            resetConnection === null || resetConnection === void 0 ? void 0 : resetConnection.unsubscribe();\n            resetConnection = undefined;\n        };\n        const reset = () => {\n            cancelReset();\n            connection = subject = undefined;\n            hasCompleted = hasErrored = false;\n        };\n        const resetAndUnsubscribe = () => {\n            const conn = connection;\n            reset();\n            conn === null || conn === void 0 ? void 0 : conn.unsubscribe();\n        };\n        return operate((source, subscriber) => {\n            refCount++;\n            if (!hasErrored && !hasCompleted) {\n                cancelReset();\n            }\n            const dest = (subject = subject !== null && subject !== void 0 ? subject : connector());\n            subscriber.add(() => {\n                refCount--;\n                if (refCount === 0 && !hasErrored && !hasCompleted) {\n                    resetConnection = handleReset(resetAndUnsubscribe, resetOnRefCountZero);\n                }\n            });\n            dest.subscribe(subscriber);\n            if (!connection &&\n                refCount > 0) {\n                connection = new SafeSubscriber({\n                    next: (value) => dest.next(value),\n                    error: (err) => {\n                        hasErrored = true;\n                        cancelReset();\n                        resetConnection = handleReset(reset, resetOnError, err);\n                        dest.error(err);\n                    },\n                    complete: () => {\n                        hasCompleted = true;\n                        cancelReset();\n                        resetConnection = handleReset(reset, resetOnComplete);\n                        dest.complete();\n                    },\n                });\n                innerFrom(source).subscribe(connection);\n            }\n        })(wrapperSource);\n    };\n}\nfunction handleReset(reset, on, ...args) {\n    if (on === true) {\n        reset();\n        return;\n    }\n    if (on === false) {\n        return;\n    }\n    const onSubscriber = new SafeSubscriber({\n        next: () => {\n            onSubscriber.unsubscribe();\n            reset();\n        },\n    });\n    return on(...args).subscribe(onSubscriber);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}