{"ast":null,"code":"import _classCallCheck from \"C:/Users/User/Projects/meanstack/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/User/Projects/meanstack/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _get from \"C:/Users/User/Projects/meanstack/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"C:/Users/User/Projects/meanstack/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"C:/Users/User/Projects/meanstack/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"C:/Users/User/Projects/meanstack/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport { Subject } from './Subject';\nimport { dateTimestampProvider } from './scheduler/dateTimestampProvider';\nexport var ReplaySubject = /*#__PURE__*/function (_Subject) {\n  _inherits(ReplaySubject, _Subject);\n  var _super = _createSuper(ReplaySubject);\n  function ReplaySubject() {\n    var _this;\n    var _bufferSize = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Infinity;\n    var _windowTime = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Infinity;\n    var _timestampProvider = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : dateTimestampProvider;\n    _classCallCheck(this, ReplaySubject);\n    _this = _super.call(this);\n    _this._bufferSize = _bufferSize;\n    _this._windowTime = _windowTime;\n    _this._timestampProvider = _timestampProvider;\n    _this._buffer = [];\n    _this._infiniteTimeWindow = true;\n    _this._infiniteTimeWindow = _windowTime === Infinity;\n    _this._bufferSize = Math.max(1, _bufferSize);\n    _this._windowTime = Math.max(1, _windowTime);\n    return _this;\n  }\n  _createClass(ReplaySubject, [{\n    key: \"next\",\n    value: function next(value) {\n      var isStopped = this.isStopped,\n        _buffer = this._buffer,\n        _infiniteTimeWindow = this._infiniteTimeWindow,\n        _timestampProvider = this._timestampProvider,\n        _windowTime = this._windowTime;\n      if (!isStopped) {\n        _buffer.push(value);\n        !_infiniteTimeWindow && _buffer.push(_timestampProvider.now() + _windowTime);\n      }\n      this._trimBuffer();\n      _get(_getPrototypeOf(ReplaySubject.prototype), \"next\", this).call(this, value);\n    }\n  }, {\n    key: \"_subscribe\",\n    value: function _subscribe(subscriber) {\n      this._throwIfClosed();\n      this._trimBuffer();\n      var subscription = this._innerSubscribe(subscriber);\n      var _infiniteTimeWindow = this._infiniteTimeWindow,\n        _buffer = this._buffer;\n      var copy = _buffer.slice();\n      for (var i = 0; i < copy.length && !subscriber.closed; i += _infiniteTimeWindow ? 1 : 2) {\n        subscriber.next(copy[i]);\n      }\n      this._checkFinalizedStatuses(subscriber);\n      return subscription;\n    }\n  }, {\n    key: \"_trimBuffer\",\n    value: function _trimBuffer() {\n      var _bufferSize = this._bufferSize,\n        _timestampProvider = this._timestampProvider,\n        _buffer = this._buffer,\n        _infiniteTimeWindow = this._infiniteTimeWindow;\n      var adjustedBufferSize = (_infiniteTimeWindow ? 1 : 2) * _bufferSize;\n      _bufferSize < Infinity && adjustedBufferSize < _buffer.length && _buffer.splice(0, _buffer.length - adjustedBufferSize);\n      if (!_infiniteTimeWindow) {\n        var now = _timestampProvider.now();\n        var last = 0;\n        for (var i = 1; i < _buffer.length && _buffer[i] <= now; i += 2) {\n          last = i;\n        }\n        last && _buffer.splice(0, last + 1);\n      }\n    }\n  }]);\n  return ReplaySubject;\n}(Subject);","map":{"version":3,"names":["Subject","dateTimestampProvider","ReplaySubject","_bufferSize","Infinity","_windowTime","_timestampProvider","_buffer","_infiniteTimeWindow","Math","max","value","isStopped","push","now","_trimBuffer","subscriber","_throwIfClosed","subscription","_innerSubscribe","copy","slice","i","length","closed","next","_checkFinalizedStatuses","adjustedBufferSize","splice","last"],"sources":["C:/Users/User/Projects/meanstack/node_modules/rxjs/dist/esm/internal/ReplaySubject.js"],"sourcesContent":["import { Subject } from './Subject';\nimport { dateTimestampProvider } from './scheduler/dateTimestampProvider';\nexport class ReplaySubject extends Subject {\n    constructor(_bufferSize = Infinity, _windowTime = Infinity, _timestampProvider = dateTimestampProvider) {\n        super();\n        this._bufferSize = _bufferSize;\n        this._windowTime = _windowTime;\n        this._timestampProvider = _timestampProvider;\n        this._buffer = [];\n        this._infiniteTimeWindow = true;\n        this._infiniteTimeWindow = _windowTime === Infinity;\n        this._bufferSize = Math.max(1, _bufferSize);\n        this._windowTime = Math.max(1, _windowTime);\n    }\n    next(value) {\n        const { isStopped, _buffer, _infiniteTimeWindow, _timestampProvider, _windowTime } = this;\n        if (!isStopped) {\n            _buffer.push(value);\n            !_infiniteTimeWindow && _buffer.push(_timestampProvider.now() + _windowTime);\n        }\n        this._trimBuffer();\n        super.next(value);\n    }\n    _subscribe(subscriber) {\n        this._throwIfClosed();\n        this._trimBuffer();\n        const subscription = this._innerSubscribe(subscriber);\n        const { _infiniteTimeWindow, _buffer } = this;\n        const copy = _buffer.slice();\n        for (let i = 0; i < copy.length && !subscriber.closed; i += _infiniteTimeWindow ? 1 : 2) {\n            subscriber.next(copy[i]);\n        }\n        this._checkFinalizedStatuses(subscriber);\n        return subscription;\n    }\n    _trimBuffer() {\n        const { _bufferSize, _timestampProvider, _buffer, _infiniteTimeWindow } = this;\n        const adjustedBufferSize = (_infiniteTimeWindow ? 1 : 2) * _bufferSize;\n        _bufferSize < Infinity && adjustedBufferSize < _buffer.length && _buffer.splice(0, _buffer.length - adjustedBufferSize);\n        if (!_infiniteTimeWindow) {\n            const now = _timestampProvider.now();\n            let last = 0;\n            for (let i = 1; i < _buffer.length && _buffer[i] <= now; i += 2) {\n                last = i;\n            }\n            last && _buffer.splice(0, last + 1);\n        }\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}